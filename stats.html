<!DOCTYPE html>
<html>
<head>
    <title>Demo Stats - Live</title>
    <meta http-equiv="refresh" content="5">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f9f9f9; }
        .container { max-width: 900px; margin: auto; }
        .stat-box { 
            background: #ffffff; 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .number { font-size: 2.2em; color: #e74c3c; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="container">
        <h1>游꿢 Demo QRphishing - Estad칤sticas en Vivo</h1>
        
        <div class="stat-box">
            <h2>游늵 Resumen</h2>
            <p>Visitantes totales: <span class="number" id="totalVisits">0</span></p>
            <p>Formularios enviados: <span class="number" id="totalSubmissions">0</span></p>
            <p>Tasa de conversi칩n: <span class="number" id="conversionRate">0.0%</span></p>
        </div>
        
        <div class="stat-box">
            <h2>游님 칔ltimas V칤ctimas (Las 10 m치s recientes)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Hora</th>
                        <th>Email</th>
                        <th>Dispositivo</th>
                    </tr>
                </thead>
                <tbody id="submissionsTableBody">
                    </tbody>
            </table>
        </div>
        
        <p><em>P치gina se actualiza autom치ticamente cada 5 segundos</em></p>
    </div>

    <script>
        // #############################################################
        // ##  INSTRUCCIONES: Edita los datos aqu칤 abajo             ##
        // ##  Puedes agregar m치s "visitas" y "submissions"        ##
        // ##  para simular datos en vivo durante tu presentaci칩n.    ##
        // #############################################################
        const demoData = {
            "visits": [
                { "user_agent": "Chrome en Windows" },
                { "user_agent": "Safari en iPhone" },
                { "user_agent": "Chrome en Android" },
                { "user_agent": "Firefox en Mac" }
            ],
            "submissions": [
                {
                    "timestamp": "2025-07-08T10:20:30.123Z",
                    "email": "victima.uno@empresa.com",
                    "device_info": { "deviceType": "M칩vil" }
                },
                {
                    "timestamp": "2025-07-08T10:22:45.456Z",
                    "email": "empleado.descuidado@corporacion.net",
                    "device_info": { "deviceType": "Escritorio" }
                }
            ]
        };

        // --- No necesitas editar nada debajo de esta l칤nea ---

        function updateStats() {
            const visits = demoData.visits;
            const submissions = demoData.submissions;

            // Calcular estad칤sticas
            const totalVisits = visits.length;
            const totalSubmissions = submissions.length;
            const conversion = totalSubmissions > 0 ? (totalSubmissions / totalVisits * 100) : 0;

            // Actualizar el resumen
            document.getElementById('totalVisits').textContent = totalVisits;
            document.getElementById('totalSubmissions').textContent = totalSubmissions;
            document.getElementById('conversionRate').textContent = `${conversion.toFixed(1)}%`;

            // Actualizar la tabla de v칤ctimas
            const tableBody = document.getElementById('submissionsTableBody');
            tableBody.innerHTML = ''; // Limpiar la tabla antes de llenarla

            // Tomar las 칰ltimas 10 y poner la m치s nueva arriba
            const latestSubmissions = submissions.slice(-10).reverse();

            if (latestSubmissions.length === 0) {
                 tableBody.innerHTML = '<tr><td colspan="3" style="text-align:center;">A칰n no hay datos enviados.</td></tr>';
            } else {
                for (const submission of latestSubmissions) {
                    const row = document.createElement('tr');
                    
                    const time = new Date(submission.timestamp).toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                    const email = submission.email;
                    const device = submission.device_info.deviceType || 'Desconocido';

                    row.innerHTML = `<td>${time}</td><td>${email}</td><td>${device}</td>`;
                    tableBody.appendChild(row);
                }
            }
        }

        // Llama a la funci칩n cuando la p치gina cargue
        window.onload = updateStats;
    </script>
</body>
</html>